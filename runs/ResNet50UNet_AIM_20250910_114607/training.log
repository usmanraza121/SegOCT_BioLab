2025-09-10 11:46:07,521 - INFO - Training ResNet50UNet_AIM Model using device: cuda
Run directory: runs/ResNet50UNet_AIM_20250910_114607
Configuration:
{
    "name": "ResNet50UNet_AIM",
    "data_root": "/media/be-light/Data/PG_Gdansk/Torun_secondment/Experiments/dataset/cityscapes",
    "num_classes": 4,
    "crop_size": 256,
    "batch_size": 2,
    "val_batch_size": 2,
    "num_epochs": 25,
    "lr": 0.0001,
    "log_dir": "runs",
    "resume": null,
    "early_stop_patience": 5
}using class weights: [1.0, 1.0, 1.0, 3.0] and gamma: 3.0

2025-09-10 11:46:07,522 - INFO - Training samples: 79, Validation samples: 20
2025-09-10 11:46:08,882 - INFO - Epoch 1 | Batch 1/40 | Loss: 2.3497 | Avg Loss: 2.3497 | GPU Memory: 12365.0MB
2025-09-10 11:46:09,202 - INFO - Epoch 1 | Batch 2/40 | Loss: 2.2623 | Avg Loss: 2.3060 | GPU Memory: 12362.3MB
2025-09-10 11:46:09,596 - INFO - Epoch 1 | Batch 3/40 | Loss: 2.1916 | Avg Loss: 2.2679 | GPU Memory: 12364.9MB
2025-09-10 11:46:09,892 - INFO - Epoch 1 | Batch 4/40 | Loss: 2.1540 | Avg Loss: 2.2394 | GPU Memory: 12369.9MB
2025-09-10 11:46:10,208 - INFO - Epoch 1 | Batch 5/40 | Loss: 2.0975 | Avg Loss: 2.2110 | GPU Memory: 12369.9MB
2025-09-10 11:46:10,540 - INFO - Epoch 1 | Batch 6/40 | Loss: 2.0491 | Avg Loss: 2.1840 | GPU Memory: 12369.9MB
2025-09-10 11:46:10,879 - INFO - Epoch 1 | Batch 7/40 | Loss: 2.0195 | Avg Loss: 2.1605 | GPU Memory: 12369.9MB
2025-09-10 11:46:11,208 - INFO - Epoch 1 | Batch 8/40 | Loss: 2.0168 | Avg Loss: 2.1426 | GPU Memory: 12369.9MB
2025-09-10 11:46:11,531 - INFO - Epoch 1 | Batch 9/40 | Loss: 1.9493 | Avg Loss: 2.1211 | GPU Memory: 12369.9MB
2025-09-10 11:46:11,860 - INFO - Epoch 1 | Batch 10/40 | Loss: 1.9465 | Avg Loss: 2.1036 | GPU Memory: 12369.9MB
2025-09-10 11:46:12,188 - INFO - Epoch 1 | Batch 11/40 | Loss: 1.8789 | Avg Loss: 2.0832 | GPU Memory: 12369.9MB
2025-09-10 11:46:12,516 - INFO - Epoch 1 | Batch 12/40 | Loss: 1.8561 | Avg Loss: 2.0643 | GPU Memory: 12369.9MB
2025-09-10 11:46:12,845 - INFO - Epoch 1 | Batch 13/40 | Loss: 1.8869 | Avg Loss: 2.0506 | GPU Memory: 12369.9MB
2025-09-10 11:46:13,171 - INFO - Epoch 1 | Batch 14/40 | Loss: 1.8412 | Avg Loss: 2.0357 | GPU Memory: 12369.9MB
2025-09-10 11:46:13,499 - INFO - Epoch 1 | Batch 15/40 | Loss: 1.7874 | Avg Loss: 2.0191 | GPU Memory: 12369.9MB
2025-09-10 11:46:13,828 - INFO - Epoch 1 | Batch 16/40 | Loss: 1.7949 | Avg Loss: 2.0051 | GPU Memory: 12369.9MB
2025-09-10 11:46:14,153 - INFO - Epoch 1 | Batch 17/40 | Loss: 1.7915 | Avg Loss: 1.9925 | GPU Memory: 12369.9MB
2025-09-10 11:46:14,481 - INFO - Epoch 1 | Batch 18/40 | Loss: 1.6978 | Avg Loss: 1.9762 | GPU Memory: 12369.9MB
2025-09-10 11:46:14,812 - INFO - Epoch 1 | Batch 19/40 | Loss: 1.7882 | Avg Loss: 1.9663 | GPU Memory: 12369.9MB
2025-09-10 11:46:15,137 - INFO - Epoch 1 | Batch 20/40 | Loss: 1.7067 | Avg Loss: 1.9533 | GPU Memory: 12369.9MB
2025-09-10 11:46:15,467 - INFO - Epoch 1 | Batch 21/40 | Loss: 1.6572 | Avg Loss: 1.9392 | GPU Memory: 12369.9MB
2025-09-10 11:46:15,797 - INFO - Epoch 1 | Batch 22/40 | Loss: 1.6735 | Avg Loss: 1.9271 | GPU Memory: 12369.9MB
2025-09-10 11:46:16,121 - INFO - Epoch 1 | Batch 23/40 | Loss: 1.6290 | Avg Loss: 1.9142 | GPU Memory: 12369.9MB
2025-09-10 11:46:16,453 - INFO - Epoch 1 | Batch 24/40 | Loss: 1.6117 | Avg Loss: 1.9016 | GPU Memory: 12369.9MB
2025-09-10 11:46:16,783 - INFO - Epoch 1 | Batch 25/40 | Loss: 1.5358 | Avg Loss: 1.8869 | GPU Memory: 12369.9MB
2025-09-10 11:46:17,107 - INFO - Epoch 1 | Batch 26/40 | Loss: 1.5620 | Avg Loss: 1.8744 | GPU Memory: 12369.9MB
2025-09-10 11:46:17,438 - INFO - Epoch 1 | Batch 27/40 | Loss: 1.4953 | Avg Loss: 1.8604 | GPU Memory: 12369.9MB
2025-09-10 11:46:17,767 - INFO - Epoch 1 | Batch 28/40 | Loss: 1.5146 | Avg Loss: 1.8480 | GPU Memory: 12369.9MB
2025-09-10 11:46:18,094 - INFO - Epoch 1 | Batch 29/40 | Loss: 1.4944 | Avg Loss: 1.8358 | GPU Memory: 12369.9MB
2025-09-10 11:46:18,426 - INFO - Epoch 1 | Batch 30/40 | Loss: 1.4690 | Avg Loss: 1.8236 | GPU Memory: 12369.9MB
2025-09-10 11:46:18,756 - INFO - Epoch 1 | Batch 31/40 | Loss: 1.4562 | Avg Loss: 1.8118 | GPU Memory: 12369.9MB
2025-09-10 11:46:19,082 - INFO - Epoch 1 | Batch 32/40 | Loss: 1.4845 | Avg Loss: 1.8015 | GPU Memory: 12369.9MB
2025-09-10 11:46:19,414 - INFO - Epoch 1 | Batch 33/40 | Loss: 1.3603 | Avg Loss: 1.7882 | GPU Memory: 12369.9MB
2025-09-10 11:46:19,739 - INFO - Epoch 1 | Batch 34/40 | Loss: 1.3699 | Avg Loss: 1.7759 | GPU Memory: 12369.9MB
2025-09-10 11:46:20,067 - INFO - Epoch 1 | Batch 35/40 | Loss: 1.2991 | Avg Loss: 1.7622 | GPU Memory: 12369.9MB
2025-09-10 11:46:20,399 - INFO - Epoch 1 | Batch 36/40 | Loss: 1.4145 | Avg Loss: 1.7526 | GPU Memory: 12369.9MB
2025-09-10 11:46:20,725 - INFO - Epoch 1 | Batch 37/40 | Loss: 1.2689 | Avg Loss: 1.7395 | GPU Memory: 12369.9MB
2025-09-10 11:46:21,054 - INFO - Epoch 1 | Batch 38/40 | Loss: 1.2453 | Avg Loss: 1.7265 | GPU Memory: 12369.9MB
2025-09-10 11:46:21,385 - INFO - Epoch 1 | Batch 39/40 | Loss: 1.2286 | Avg Loss: 1.7137 | GPU Memory: 12369.9MB
2025-09-10 11:46:21,895 - INFO - Epoch 1 | Batch 40/40 | Loss: 1.1954 | Avg Loss: 1.6858 | GPU Memory: 12367.3MB
2025-09-10 11:46:22,623 - INFO - Epoch 1 completed. Loss: 1.7072, Time: 15.1s
2025-09-10 11:47:16,012 - INFO - Validation | Loss: 1.2063, mIoU: 0.7054, IoUs: [0.97928378 0.82840813 0.58147651 0.432545  ]
2025-09-10 11:47:18,648 - INFO - Saved best model at epoch 1 to runs/ResNet50UNet_AIM_20250910_114607/checkpoints/ResNet50UNet_AIM_best.pth
2025-09-10 11:47:19,421 - INFO - Epoch 2 | Batch 1/40 | Loss: 1.2539 | Avg Loss: 1.2539 | GPU Memory: 12365.2MB
2025-09-10 11:47:19,754 - INFO - Epoch 2 | Batch 2/40 | Loss: 1.2065 | Avg Loss: 1.2302 | GPU Memory: 12367.5MB
2025-09-10 11:47:20,078 - INFO - Epoch 2 | Batch 3/40 | Loss: 1.1837 | Avg Loss: 1.2147 | GPU Memory: 12367.5MB
2025-09-10 11:47:20,411 - INFO - Epoch 2 | Batch 4/40 | Loss: 1.1843 | Avg Loss: 1.2071 | GPU Memory: 12367.5MB
2025-09-10 11:47:20,741 - INFO - Epoch 2 | Batch 5/40 | Loss: 1.1470 | Avg Loss: 1.1951 | GPU Memory: 12367.5MB
2025-09-10 11:47:21,073 - INFO - Epoch 2 | Batch 6/40 | Loss: 1.0727 | Avg Loss: 1.1747 | GPU Memory: 12367.5MB
2025-09-10 11:47:21,403 - INFO - Epoch 2 | Batch 7/40 | Loss: 1.0399 | Avg Loss: 1.1554 | GPU Memory: 12367.5MB
2025-09-10 11:47:21,741 - INFO - Epoch 2 | Batch 8/40 | Loss: 1.1123 | Avg Loss: 1.1501 | GPU Memory: 12367.5MB
2025-09-10 11:47:22,073 - INFO - Epoch 2 | Batch 9/40 | Loss: 1.0374 | Avg Loss: 1.1375 | GPU Memory: 12367.5MB
2025-09-10 11:47:22,404 - INFO - Epoch 2 | Batch 10/40 | Loss: 1.0453 | Avg Loss: 1.1283 | GPU Memory: 12367.5MB
2025-09-10 11:47:22,740 - INFO - Epoch 2 | Batch 11/40 | Loss: 0.9742 | Avg Loss: 1.1143 | GPU Memory: 12367.5MB
2025-09-10 11:47:23,072 - INFO - Epoch 2 | Batch 12/40 | Loss: 1.1128 | Avg Loss: 1.1142 | GPU Memory: 12367.5MB
2025-09-10 11:47:23,402 - INFO - Epoch 2 | Batch 13/40 | Loss: 0.9519 | Avg Loss: 1.1017 | GPU Memory: 12367.5MB
2025-09-10 11:47:23,736 - INFO - Epoch 2 | Batch 14/40 | Loss: 0.9025 | Avg Loss: 1.0875 | GPU Memory: 12367.5MB
2025-09-10 11:47:24,068 - INFO - Epoch 2 | Batch 15/40 | Loss: 0.9079 | Avg Loss: 1.0755 | GPU Memory: 12367.5MB
2025-09-10 11:47:24,399 - INFO - Epoch 2 | Batch 16/40 | Loss: 0.9827 | Avg Loss: 1.0697 | GPU Memory: 12367.5MB
2025-09-10 11:47:24,730 - INFO - Epoch 2 | Batch 17/40 | Loss: 1.0411 | Avg Loss: 1.0680 | GPU Memory: 12367.5MB
2025-09-10 11:47:25,063 - INFO - Epoch 2 | Batch 18/40 | Loss: 0.8974 | Avg Loss: 1.0585 | GPU Memory: 12367.5MB
2025-09-10 11:47:25,395 - INFO - Epoch 2 | Batch 19/40 | Loss: 0.8501 | Avg Loss: 1.0476 | GPU Memory: 12367.5MB
2025-09-10 11:47:25,726 - INFO - Epoch 2 | Batch 20/40 | Loss: 0.8296 | Avg Loss: 1.0367 | GPU Memory: 12367.5MB
2025-09-10 11:47:26,062 - INFO - Epoch 2 | Batch 21/40 | Loss: 0.8044 | Avg Loss: 1.0256 | GPU Memory: 12367.5MB
2025-09-10 11:47:26,395 - INFO - Epoch 2 | Batch 22/40 | Loss: 0.7814 | Avg Loss: 1.0145 | GPU Memory: 12367.5MB
2025-09-10 11:47:26,726 - INFO - Epoch 2 | Batch 23/40 | Loss: 0.7573 | Avg Loss: 1.0033 | GPU Memory: 12367.5MB
2025-09-10 11:47:27,061 - INFO - Epoch 2 | Batch 24/40 | Loss: 0.7435 | Avg Loss: 0.9925 | GPU Memory: 12367.5MB
2025-09-10 11:47:27,386 - INFO - Epoch 2 | Batch 25/40 | Loss: 0.7429 | Avg Loss: 0.9825 | GPU Memory: 12367.5MB
2025-09-10 11:47:27,700 - INFO - Epoch 2 | Batch 26/40 | Loss: 0.7224 | Avg Loss: 0.9725 | GPU Memory: 12367.5MB
2025-09-10 11:47:28,017 - INFO - Epoch 2 | Batch 27/40 | Loss: 0.6966 | Avg Loss: 0.9623 | GPU Memory: 12367.5MB
2025-09-10 11:47:28,336 - INFO - Epoch 2 | Batch 28/40 | Loss: 0.7933 | Avg Loss: 0.9563 | GPU Memory: 12367.5MB
2025-09-10 11:47:28,650 - INFO - Epoch 2 | Batch 29/40 | Loss: 0.6625 | Avg Loss: 0.9461 | GPU Memory: 12367.5MB
2025-09-10 11:47:28,972 - INFO - Epoch 2 | Batch 30/40 | Loss: 0.9135 | Avg Loss: 0.9450 | GPU Memory: 12367.5MB
2025-09-10 11:47:29,290 - INFO - Epoch 2 | Batch 31/40 | Loss: 0.7889 | Avg Loss: 0.9400 | GPU Memory: 12367.5MB
2025-09-10 11:47:29,610 - INFO - Epoch 2 | Batch 32/40 | Loss: 0.7506 | Avg Loss: 0.9341 | GPU Memory: 12367.5MB
2025-09-10 11:47:29,928 - INFO - Epoch 2 | Batch 33/40 | Loss: 0.7276 | Avg Loss: 0.9278 | GPU Memory: 12367.5MB
2025-09-10 11:47:30,248 - INFO - Epoch 2 | Batch 34/40 | Loss: 0.7466 | Avg Loss: 0.9225 | GPU Memory: 12367.5MB
2025-09-10 11:47:30,569 - INFO - Epoch 2 | Batch 35/40 | Loss: 0.7112 | Avg Loss: 0.9165 | GPU Memory: 12367.5MB
2025-09-10 11:47:30,887 - INFO - Epoch 2 | Batch 36/40 | Loss: 0.6757 | Avg Loss: 0.9098 | GPU Memory: 12367.5MB
2025-09-10 11:47:31,207 - INFO - Epoch 2 | Batch 37/40 | Loss: 0.6968 | Avg Loss: 0.9040 | GPU Memory: 12367.5MB
2025-09-10 11:47:31,525 - INFO - Epoch 2 | Batch 38/40 | Loss: 0.6831 | Avg Loss: 0.8982 | GPU Memory: 12367.5MB
2025-09-10 11:47:31,845 - INFO - Epoch 2 | Batch 39/40 | Loss: 0.5910 | Avg Loss: 0.8903 | GPU Memory: 12367.5MB
2025-09-10 11:47:32,134 - INFO - Epoch 2 | Batch 40/40 | Loss: 0.5675 | Avg Loss: 0.8752 | GPU Memory: 12364.9MB
2025-09-10 11:47:32,893 - INFO - Epoch 2 completed. Loss: 0.8862, Time: 14.2s
