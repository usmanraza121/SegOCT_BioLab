2025-09-10 14:44:10,252 - INFO - Training ResNet50UNet_DAC Model using device: cuda
Run directory: runs/ResNet50UNet_DAC_20250910_144410
Configuration:
{
    "name": "ResNet50UNet_DAC",
    "data_root": "/media/be-light/Data/PG_Gdansk/Torun_secondment/Experiments/dataset/cityscapes",
    "num_classes": 4,
    "crop_size": 256,
    "batch_size": 8,
    "val_batch_size": 4,
    "num_epochs": 25,
    "lr": 0.0001,
    "log_dir": "runs",
    "resume": null,
    "early_stop_patience": 5
}using class weights: [1.0, 1.0, 1.0, 3.0] and gamma: 3.0

2025-09-10 14:44:10,253 - INFO - Training samples: 79, Validation samples: 20
2025-09-10 14:44:11,702 - INFO - Epoch 1 | Batch 1/10 | Loss: 2.3940 | Avg Loss: 2.3940 | GPU Memory: 7186.9MB
2025-09-10 14:44:11,998 - INFO - Epoch 1 | Batch 2/10 | Loss: 2.3064 | Avg Loss: 2.3502 | GPU Memory: 7184.1MB
2025-09-10 14:44:12,271 - INFO - Epoch 1 | Batch 3/10 | Loss: 2.2462 | Avg Loss: 2.3155 | GPU Memory: 7188.6MB
2025-09-10 14:44:12,543 - INFO - Epoch 1 | Batch 4/10 | Loss: 2.2013 | Avg Loss: 2.2869 | GPU Memory: 7184.2MB
2025-09-10 14:44:12,832 - INFO - Epoch 1 | Batch 5/10 | Loss: 2.1484 | Avg Loss: 2.2592 | GPU Memory: 7184.2MB
2025-09-10 14:44:13,116 - INFO - Epoch 1 | Batch 6/10 | Loss: 2.1100 | Avg Loss: 2.2344 | GPU Memory: 7184.2MB
2025-09-10 14:44:13,400 - INFO - Epoch 1 | Batch 7/10 | Loss: 2.0682 | Avg Loss: 2.2106 | GPU Memory: 7184.2MB
2025-09-10 14:44:13,688 - INFO - Epoch 1 | Batch 8/10 | Loss: 2.0292 | Avg Loss: 2.1879 | GPU Memory: 7184.2MB
2025-09-10 14:44:13,966 - INFO - Epoch 1 | Batch 9/10 | Loss: 1.9871 | Avg Loss: 2.1656 | GPU Memory: 7184.2MB
2025-09-10 14:44:14,254 - INFO - Epoch 1 | Batch 10/10 | Loss: 1.9689 | Avg Loss: 2.1214 | GPU Memory: 7188.4MB
2025-09-10 14:44:14,959 - INFO - Epoch 1 completed. Loss: 2.1482, Time: 4.7s
2025-09-10 14:45:07,117 - INFO - Validation | Loss: 2.2512, mIoU: 0.4709, IoUs: [0.88980067 0.29359817 0.35448266 0.34567115]
2025-09-10 14:45:09,156 - INFO - Saved best model at epoch 1 to runs/ResNet50UNet_DAC_20250910_144410/checkpoints/ResNet50UNet_DAC_best.pth
2025-09-10 14:45:10,089 - INFO - Epoch 2 | Batch 1/10 | Loss: 1.9204 | Avg Loss: 1.9204 | GPU Memory: 7186.8MB
2025-09-10 14:45:10,390 - INFO - Epoch 2 | Batch 2/10 | Loss: 1.9101 | Avg Loss: 1.9153 | GPU Memory: 7187.1MB
2025-09-10 14:45:10,704 - INFO - Epoch 2 | Batch 3/10 | Loss: 1.8560 | Avg Loss: 1.8955 | GPU Memory: 7185.3MB
2025-09-10 14:45:10,994 - INFO - Epoch 2 | Batch 4/10 | Loss: 1.8449 | Avg Loss: 1.8828 | GPU Memory: 7187.1MB
2025-09-10 14:45:11,281 - INFO - Epoch 2 | Batch 5/10 | Loss: 1.8541 | Avg Loss: 1.8771 | GPU Memory: 7183.8MB
2025-09-10 14:45:11,570 - INFO - Epoch 2 | Batch 6/10 | Loss: 1.7803 | Avg Loss: 1.8610 | GPU Memory: 7184.2MB
2025-09-10 14:45:11,862 - INFO - Epoch 2 | Batch 7/10 | Loss: 1.7421 | Avg Loss: 1.8440 | GPU Memory: 7184.2MB
2025-09-10 14:45:12,148 - INFO - Epoch 2 | Batch 8/10 | Loss: 1.7320 | Avg Loss: 1.8300 | GPU Memory: 7184.2MB
2025-09-10 14:45:12,432 - INFO - Epoch 2 | Batch 9/10 | Loss: 1.7451 | Avg Loss: 1.8205 | GPU Memory: 7184.2MB
2025-09-10 14:45:12,692 - INFO - Epoch 2 | Batch 10/10 | Loss: 1.6774 | Avg Loss: 1.7853 | GPU Memory: 7188.4MB
2025-09-10 14:45:13,422 - INFO - Epoch 2 completed. Loss: 1.8079, Time: 4.3s
2025-09-10 14:46:06,728 - INFO - Validation | Loss: 1.9391, mIoU: 0.6348, IoUs: [0.94370358 0.598561   0.55690214 0.43991193]
2025-09-10 14:46:08,788 - INFO - Saved best model at epoch 2 to runs/ResNet50UNet_DAC_20250910_144410/checkpoints/ResNet50UNet_DAC_best.pth
2025-09-10 14:46:09,727 - INFO - Epoch 3 | Batch 1/10 | Loss: 1.6188 | Avg Loss: 1.6188 | GPU Memory: 7186.8MB
2025-09-10 14:46:10,016 - INFO - Epoch 3 | Batch 2/10 | Loss: 1.6195 | Avg Loss: 1.6191 | GPU Memory: 7187.1MB
2025-09-10 14:46:10,333 - INFO - Epoch 3 | Batch 3/10 | Loss: 1.5772 | Avg Loss: 1.6052 | GPU Memory: 7185.3MB
2025-09-10 14:46:10,638 - INFO - Epoch 3 | Batch 4/10 | Loss: 1.5538 | Avg Loss: 1.5923 | GPU Memory: 7187.1MB
2025-09-10 14:46:10,978 - INFO - Epoch 3 | Batch 5/10 | Loss: 1.5519 | Avg Loss: 1.5842 | GPU Memory: 7183.8MB
2025-09-10 14:46:11,369 - INFO - Epoch 3 | Batch 6/10 | Loss: 1.5197 | Avg Loss: 1.5735 | GPU Memory: 7184.2MB
2025-09-10 14:46:11,696 - INFO - Epoch 3 | Batch 7/10 | Loss: 1.5201 | Avg Loss: 1.5659 | GPU Memory: 7184.2MB
2025-09-10 14:46:11,982 - INFO - Epoch 3 | Batch 8/10 | Loss: 1.4540 | Avg Loss: 1.5519 | GPU Memory: 7184.2MB
2025-09-10 14:46:12,306 - INFO - Epoch 3 | Batch 9/10 | Loss: 1.4614 | Avg Loss: 1.5418 | GPU Memory: 7184.2MB
2025-09-10 14:46:12,599 - INFO - Epoch 3 | Batch 10/10 | Loss: 1.4075 | Avg Loss: 1.5108 | GPU Memory: 7188.4MB
2025-09-10 14:46:13,321 - INFO - Epoch 3 completed. Loss: 1.5299, Time: 4.5s
